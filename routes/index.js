var express = require('express');
var router = express.Router();
var mongoose = require('mongoose');

//twitter setup//
var Twitter = require('twitter');

var client = new Twitter({
  consumer_key: process.env.TWITTER_CONSUMER_KEY,
  consumer_secret: process.env.TWITTER_CONSUMER_SECRET,
  access_token_key: process.env.TWITTER_ACCESS_TOKEN_KEY,
  access_token_secret: process.env.TWITTER_ACCESS_TOKEN_SECRET
});

var http = require("http");
setInterval(function() {
    http.get("http://emojiconheattracker.herokuapp.com/api/listen");
}, 300000); // every 5 minutes (300000)

var Emoji = require("../models/model.js");

var allEmojis = ['ğŸ˜€','ğŸ˜¬','ğŸ˜','ğŸ˜‚','ğŸ˜ƒ','ğŸ˜„','ğŸ˜…','ğŸ˜†','ğŸ˜‡','ğŸ˜‰','ğŸ˜Š','ğŸ™‚','ğŸ™ƒ','â˜ºï¸','ğŸ˜‹','ğŸ˜Œ','ğŸ˜','ğŸ˜˜','ğŸ˜—','ğŸ˜™','ğŸ˜š','ğŸ˜œ','ğŸ˜','ğŸ˜›','ğŸ¤‘','ğŸ¤“','ğŸ˜','ğŸ¤—','ğŸ˜','ğŸ˜¶','ğŸ˜','ğŸ˜‘','ğŸ˜’','ğŸ™„','ğŸ¤”','ğŸ˜³','ğŸ˜','ğŸ˜Ÿ','ğŸ˜ ','ğŸ˜¡','ğŸ˜”','ğŸ˜•','ğŸ™','â˜¹ï¸','ğŸ˜£','ğŸ˜–','ğŸ˜«','ğŸ˜©','ğŸ˜¤','ğŸ˜®','ğŸ˜±','ğŸ˜¨','ğŸ˜°','ğŸ˜¯','ğŸ˜¦','ğŸ˜§','ğŸ˜¢','ğŸ˜¥','ğŸ˜ª','ğŸ˜“','ğŸ˜­','ğŸ˜µ','ğŸ˜²','ğŸ¤','ğŸ˜·','ğŸ¤’','ğŸ¤•','ğŸ˜´','ğŸ’¤','ğŸ’©','ğŸ˜ˆ','ğŸ‘¿','ğŸ‘¹','ğŸ‘º','ğŸ’€','ğŸ‘»','ğŸ‘½','ğŸ¤–','ğŸ˜º','ğŸ˜¸','ğŸ˜¹','ğŸ˜»','ğŸ˜¼','ğŸ˜½','ğŸ™€','ğŸ˜¿','ğŸ˜¾','ğŸ™Œ','ğŸ‘','ğŸ‘‹','ğŸ‘','ğŸ‘Š','âœŠ','âœŒï¸','ğŸ‘Œ','âœ‹','ğŸ’ª','ğŸ™','â˜ï¸','ğŸ‘†','ğŸ‘‡','ğŸ‘ˆ','ğŸ‘‰','ğŸ–•','ğŸ¤˜','ğŸ––','âœï¸','ğŸ’…','ğŸ‘„','ğŸ‘…','ğŸ‘‚','ğŸ‘ƒ','ğŸ‘','ğŸ‘€','ğŸ‘¤','ğŸ—£','ğŸ‘¶','ğŸ‘¦','ğŸ‘§','ğŸ‘¨','ğŸ‘©','ğŸ‘±','ğŸ‘´','ğŸ‘µ','ğŸ‘²','ğŸ‘³','ğŸ‘®','ğŸ‘·','ğŸ’‚','ğŸ•µ','ğŸ…','ğŸ‘¼','ğŸ‘¸','ğŸ‘°','ğŸš¶','ğŸƒ','ğŸ’ƒ','ğŸ‘¯','ğŸ‘«','ğŸ‘¬','ğŸ‘­','ğŸ™‡','ğŸ’','ğŸ™…','ğŸ™†','ğŸ™‹','ğŸ™','ğŸ™','ğŸ’‡','ğŸ’†','ğŸ’‘','ğŸ‘©â€â¤ï¸â€ğŸ‘©','ğŸ‘¨â€â¤ï¸â€ğŸ‘¨','ğŸ’','ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©','ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨','ğŸ‘ª','ğŸ‘¨â€ğŸ‘©â€ğŸ‘§','ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦','ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦','ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§','ğŸ‘©â€ğŸ‘©â€ğŸ‘¦','ğŸ‘©â€ğŸ‘©â€ğŸ‘§','ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦','ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦','ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§','ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦','ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§','ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦','ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦','ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§','ğŸ‘š','ğŸ‘•','ğŸ‘–','ğŸ‘”','ğŸ‘—','ğŸ‘™','ğŸ‘˜','ğŸ’„','ğŸ’‹','ğŸ‘£','ğŸ‘ ','ğŸ‘¡','ğŸ‘¢','ğŸ‘','ğŸ‘Ÿ','ğŸ‘’','ğŸ©','â›‘','ğŸ“','ğŸ‘‘','ğŸ’','ğŸ‘','ğŸ‘›','ğŸ‘œ','ğŸ’¼','ğŸ‘“','ğŸ•¶','ğŸ’','ğŸŒ‚ğŸ‘¦ğŸ»','ğŸ‘§ğŸ»','ğŸ‘¨ğŸ»','ğŸ‘©ğŸ»','ğŸ‘´ğŸ»','ğŸ‘µğŸ»','ğŸ‘¶ğŸ»','ğŸ‘±ğŸ»','ğŸ‘®ğŸ»','ğŸ‘²ğŸ»','ğŸ‘³ğŸ»','ğŸ‘·ğŸ»','ğŸ‘¸ğŸ»','ğŸ’‚ğŸ»','ğŸ…ğŸ»','ğŸ‘¼ğŸ»','ğŸ’†ğŸ»','ğŸ’‡ğŸ»','ğŸ‘°ğŸ»','ğŸ™ğŸ»','ğŸ™ğŸ»','ğŸ™…ğŸ»','ğŸ™†ğŸ»','ğŸ’ğŸ»','ğŸ™‹ğŸ»','ğŸ™‡ğŸ»','ğŸ™ŒğŸ»','ğŸ™ğŸ»','ğŸš¶ğŸ»','ğŸƒğŸ»','ğŸ’ƒğŸ»','ğŸ’ªğŸ»','ğŸ‘ˆğŸ»','ğŸ‘‰ğŸ»','â˜ï¸ğŸ»','ğŸ‘†ğŸ»','ğŸ–•ğŸ»','ğŸ‘‡ğŸ»','âœŒï¸ğŸ»','ğŸ––ğŸ»','ğŸ¤˜ğŸ»','ğŸ–ğŸ»','âœŠğŸ»','âœ‹ğŸ»','ğŸ‘ŠğŸ»','ğŸ‘ŒğŸ»','ğŸ‘ğŸ»','ğŸ‘ğŸ»','ğŸ‘‹ğŸ»','ğŸ‘ğŸ»','ğŸ‘ğŸ»','âœğŸ»','ğŸ’…ğŸ»','ğŸ‘‚ğŸ»','ğŸ‘ƒğŸ»','ğŸš£ğŸ»','ğŸ›€ğŸ»','ğŸ„ğŸ»','ğŸ‡ğŸ»','ğŸŠğŸ»','â›¹ğŸ»','ğŸ‹ğŸ»','ğŸš´ğŸ»','ğŸšµğŸ»ğŸ‘¦ğŸ¼','ğŸ‘§ğŸ¼','ğŸ‘¨ğŸ¼','ğŸ‘©ğŸ¼','ğŸ‘´ğŸ¼','ğŸ‘µğŸ¼','ğŸ‘¶ğŸ¼','ğŸ‘±ğŸ¼','ğŸ‘®ğŸ¼','ğŸ‘²ğŸ¼','ğŸ‘³ğŸ¼','ğŸ‘·ğŸ¼','ğŸ‘¸ğŸ¼','ğŸ’‚ğŸ¼','ğŸ…ğŸ¼','ğŸ‘¼ğŸ¼','ğŸ’†ğŸ¼','ğŸ’‡ğŸ¼','ğŸ‘°ğŸ¼','ğŸ™ğŸ¼','ğŸ™ğŸ¼','ğŸ™…ğŸ¼','ğŸ™†ğŸ¼','ğŸ’ğŸ¼','ğŸ™‹ğŸ¼','ğŸ™‡ğŸ¼','ğŸ™ŒğŸ¼','ğŸ™ğŸ¼','ğŸš¶ğŸ¼','ğŸƒğŸ¼','ğŸ’ƒğŸ¼','ğŸ’ªğŸ¼','ğŸ‘ˆğŸ¼','ğŸ‘‰ğŸ¼','â˜ï¸ğŸ¼','ğŸ‘†ğŸ¼','ğŸ–•ğŸ¼','ğŸ‘‡ğŸ¼','âœŒï¸ğŸ¼','ğŸ––ğŸ¼','ğŸ¤˜ğŸ¼','ğŸ–ğŸ¼','âœŠğŸ¼','âœ‹ğŸ¼','ğŸ‘ŠğŸ¼','ğŸ‘ŒğŸ¼','ğŸ‘ğŸ¼','ğŸ‘ğŸ¼','ğŸ‘‹ğŸ¼','ğŸ‘ğŸ¼','ğŸ‘ğŸ¼','âœğŸ¼','ğŸ’…ğŸ¼','ğŸ‘‚ğŸ¼','ğŸ‘ƒğŸ¼','ğŸš£ğŸ¼','ğŸ›€ğŸ¼','ğŸ„ğŸ¼','ğŸ‡ğŸ¼','ğŸŠğŸ¼','â›¹ğŸ¼','ğŸ‹ğŸ¼','ğŸš´ğŸ¼','ğŸšµğŸ¼ğŸ‘¦ğŸ½','ğŸ‘§ğŸ½','ğŸ‘¨ğŸ½','ğŸ‘©ğŸ½','ğŸ‘´ğŸ½','ğŸ‘µğŸ½','ğŸ‘¶ğŸ½','ğŸ‘±ğŸ½','ğŸ‘®ğŸ½','ğŸ‘²ğŸ½','ğŸ‘³ğŸ½','ğŸ‘·ğŸ½','ğŸ‘¸ğŸ½','ğŸ’‚ğŸ½','ğŸ…ğŸ½','ğŸ‘¼ğŸ½','ğŸ’†ğŸ½','ğŸ’‡ğŸ½','ğŸ‘°ğŸ½','ğŸ™ğŸ½','ğŸ™ğŸ½','ğŸ™…ğŸ½','ğŸ™†ğŸ½','ğŸ’ğŸ½','ğŸ™‹ğŸ½','ğŸ™‡ğŸ½','ğŸ™ŒğŸ½','ğŸ™ğŸ½','ğŸš¶ğŸ½','ğŸƒğŸ½','ğŸ’ƒğŸ½','ğŸ’ªğŸ½','ğŸ‘ˆğŸ½','ğŸ‘‰ğŸ½','â˜ï¸ğŸ½','ğŸ‘†ğŸ½','ğŸ–•ğŸ½','ğŸ‘‡ğŸ½','âœŒï¸ğŸ½','ğŸ––ğŸ½','ğŸ¤˜ğŸ½','ğŸ–ğŸ½','âœŠğŸ½','âœ‹ğŸ½','ğŸ‘ŠğŸ½','ğŸ‘ŒğŸ½','ğŸ‘ğŸ½','ğŸ‘ğŸ½','ğŸ‘‹ğŸ½','ğŸ‘ğŸ½','ğŸ‘ğŸ½','âœğŸ½','ğŸ’…ğŸ½','ğŸ‘‚ğŸ½','ğŸ‘ƒğŸ½','ğŸš£ğŸ½','ğŸ›€ğŸ½','ğŸ„ğŸ½','ğŸ‡ğŸ½','ğŸŠğŸ½','â›¹ğŸ½','ğŸ‹ğŸ½','ğŸš´ğŸ½','ğŸšµğŸ½ğŸ‘¦ğŸ¾','ğŸ‘§ğŸ¾','ğŸ‘¨ğŸ¾','ğŸ‘©ğŸ¾','ğŸ‘´ğŸ¾','ğŸ‘µğŸ¾','ğŸ‘¶ğŸ¾','ğŸ‘±ğŸ¾','ğŸ‘®ğŸ¾','ğŸ‘²ğŸ¾','ğŸ‘³ğŸ¾','ğŸ‘·ğŸ¾','ğŸ‘¸ğŸ¾','ğŸ’‚ğŸ¾','ğŸ…ğŸ¾','ğŸ‘¼ğŸ¾','ğŸ’†ğŸ¾','ğŸ’‡ğŸ¾','ğŸ‘°ğŸ¾','ğŸ™ğŸ¾','ğŸ™ğŸ¾','ğŸ™…ğŸ¾','ğŸ™†ğŸ¾','ğŸ’ğŸ¾','ğŸ™‹ğŸ¾','ğŸ™‡ğŸ¾','ğŸ™ŒğŸ¾','ğŸ™ğŸ¾','ğŸš¶ğŸ¾','ğŸƒğŸ¾','ğŸ’ƒğŸ¾','ğŸ’ªğŸ¾','ğŸ‘ˆğŸ¾','ğŸ‘‰ğŸ¾','â˜ï¸ğŸ¾','ğŸ‘†ğŸ¾','ğŸ–•ğŸ¾','ğŸ‘‡ğŸ¾','âœŒï¸ğŸ¾','ğŸ––ğŸ¾','ğŸ¤˜ğŸ¾','ğŸ–ğŸ¾','âœŠğŸ¾','âœ‹ğŸ¾','ğŸ‘ŠğŸ¾','ğŸ‘ŒğŸ¾','ğŸ‘ğŸ¾','ğŸ‘ğŸ¾','ğŸ‘‹ğŸ¾','ğŸ‘ğŸ¾','ğŸ‘ğŸ¾','âœğŸ¾','ğŸ’…ğŸ¾','ğŸ‘‚ğŸ¾','ğŸ‘ƒğŸ¾','ğŸš£ğŸ¾','ğŸ›€ğŸ¾','ğŸ„ğŸ¾','ğŸ‡ğŸ¾','ğŸŠğŸ¾','â›¹ğŸ¾','ğŸ‹ğŸ¾','ğŸš´ğŸ¾','ğŸšµğŸ¾ğŸ‘¦ğŸ¿','ğŸ‘§ğŸ¿','ğŸ‘¨ğŸ¿','ğŸ‘©ğŸ¿','ğŸ‘´ğŸ¿','ğŸ‘µğŸ¿','ğŸ‘¶ğŸ¿','ğŸ‘±ğŸ¿','ğŸ‘®ğŸ¿','ğŸ‘²ğŸ¿','ğŸ‘³ğŸ¿','ğŸ‘·ğŸ¿','ğŸ‘¸ğŸ¿','ğŸ’‚ğŸ¿','ğŸ…ğŸ¿','ğŸ‘¼ğŸ¿','ğŸ’†ğŸ¿','ğŸ’‡ğŸ¿','ğŸ‘°ğŸ¿','ğŸ™ğŸ¿','ğŸ™ğŸ¿','ğŸ™…ğŸ¿','ğŸ™†ğŸ¿','ğŸ’ğŸ¿','ğŸ™‹ğŸ¿','ğŸ™‡ğŸ¿','ğŸ™ŒğŸ¿','ğŸ™ğŸ¿','ğŸš¶ğŸ¿','ğŸƒğŸ¿','ğŸ’ƒğŸ¿','ğŸ’ªğŸ¿','ğŸ‘ˆğŸ¿','ğŸ‘‰ğŸ¿','â˜ï¸ğŸ¿','ğŸ‘†ğŸ¿','ğŸ–•ğŸ¿','ğŸ‘‡ğŸ¿','âœŒï¸ğŸ¿','ğŸ––ğŸ¿','ğŸ¤˜ğŸ¿','ğŸ–ğŸ¿','âœŠğŸ¿','âœ‹ğŸ¿','ğŸ‘ŠğŸ¿','ğŸ‘ŒğŸ¿','ğŸ‘ğŸ¿','ğŸ‘ğŸ¿','ğŸ‘‹ğŸ¿','ğŸ‘ğŸ¿','ğŸ‘ğŸ¿','âœğŸ¿','ğŸ’…ğŸ¿','ğŸ‘‚ğŸ¿','ğŸ‘ƒğŸ¿','ğŸš£ğŸ¿','ğŸ›€ğŸ¿','ğŸ„ğŸ¿','ğŸ‡ğŸ¿','ğŸŠğŸ¿','â›¹ğŸ¿','ğŸ‹ğŸ¿','ğŸš´ğŸ¿','ğŸšµğŸ¿ğŸ¶','ğŸ±','ğŸ­','ğŸ¹','ğŸ°','ğŸ»','ğŸ¼','ğŸ¨','ğŸ¯','ğŸ¦','ğŸ®','ğŸ·','ğŸ½','ğŸ¸','ğŸ™','ğŸµ','ğŸ™ˆ','ğŸ™‰','ğŸ™Š','ğŸ’','ğŸ”','ğŸ§','ğŸ¦','ğŸ¤','ğŸ£','ğŸ¥','ğŸº','ğŸ—','ğŸ´','ğŸ¦„','ğŸ','ğŸ›','ğŸŒ','ğŸ','ğŸœ','ğŸ•·','ğŸ¦‚','ğŸ¦€','ğŸ','ğŸ¢','ğŸ ','ğŸŸ','ğŸ¡','ğŸ¬','ğŸ³','ğŸ‹','ğŸŠ','ğŸ†','ğŸ…','ğŸƒ','ğŸ‚','ğŸ„','ğŸª','ğŸ«','ğŸ˜','ğŸ','ğŸ','ğŸ‘','ğŸ','ğŸ–','ğŸ€','ğŸ','ğŸ“','ğŸ¦ƒ','ğŸ•Š','ğŸ•','ğŸ©','ğŸˆ','ğŸ‡','ğŸ¿','ğŸ¾','ğŸ‰','ğŸ²','ğŸŒµ','ğŸ„','ğŸŒ²','ğŸŒ³','ğŸŒ´','ğŸŒ±','ğŸŒ¿','â˜˜','ğŸ€','ğŸ','ğŸ‹','ğŸƒ','ğŸ‚','ğŸ','ğŸŒ¾','ğŸŒº','ğŸŒ»','ğŸŒ¹','ğŸŒ·','ğŸŒ¼','ğŸŒ¸','ğŸ’','ğŸ„','ğŸŒ°','ğŸƒ','ğŸš','ğŸ•¸','ğŸŒ','ğŸŒ','ğŸŒ','ğŸŒ•','ğŸŒ–','ğŸŒ—','ğŸŒ˜','ğŸŒ‘','ğŸŒ’','ğŸŒ“','ğŸŒ”','ğŸŒš','ğŸŒ','ğŸŒ›','ğŸŒœ','ğŸŒ','ğŸŒ™','â­ï¸','ğŸŒŸ','ğŸ’«','âœ¨','â˜„','â˜€ï¸','ğŸŒ¤','â›…ï¸','ğŸŒ¥','ğŸŒ¦','â˜ï¸','ğŸŒ§','â›ˆ','ğŸŒ©','âš¡ï¸','ğŸ”¥','ğŸ’¥','â„ï¸','ğŸŒ¨','ğŸ”¥','ğŸ’¥','â„ï¸','ğŸŒ¨','â˜ƒï¸','â›„ï¸','ğŸŒ¬','ğŸ’¨','ğŸŒª','ğŸŒ«','â˜‚ï¸','â˜”ï¸','ğŸ’§','ğŸ’¦','ğŸŒŠğŸ','ğŸ','ğŸ','ğŸŠ','ğŸ‹','ğŸŒ','ğŸ‰','ğŸ‡','ğŸ“','ğŸˆ','ğŸ’','ğŸ‘','ğŸ','ğŸ…','ğŸ†','ğŸŒ¶','ğŸŒ½','ğŸ ','ğŸ¯','ğŸ','ğŸ§€','ğŸ—','ğŸ–','ğŸ¤','ğŸ³','ğŸ”','ğŸŸ','ğŸŒ­','ğŸ•','ğŸ','ğŸŒ®','ğŸŒ¯','ğŸœ','ğŸ²','ğŸ¥','ğŸ£','ğŸ±','ğŸ›','ğŸ™','ğŸš','ğŸ˜','ğŸ¢','ğŸ¡','ğŸ§','ğŸ¨','ğŸ¦','ğŸ°','ğŸ‚','ğŸ®','ğŸ¬','ğŸ­','ğŸ«','ğŸ¿','ğŸ©','ğŸª','ğŸº','ğŸ»','ğŸ·','ğŸ¸','ğŸ¹','ğŸ¾','ğŸ¶','ğŸµ','â˜•ï¸','ğŸ¼','ğŸ´','ğŸ½âš½ï¸','ğŸ€','ğŸˆ','âš¾ï¸','ğŸ¾','ğŸ','ğŸ‰','ğŸ±','â›³ï¸','ğŸŒ','ğŸ“','ğŸ¸','ğŸ’','ğŸ‘','ğŸ','ğŸ¿','â›·','ğŸ‚','â›¸','ğŸ¹','ğŸ£','ğŸš£','ğŸŠ','ğŸ„','ğŸ›€','â›¹','ğŸ‹','ğŸš´','ğŸšµ','ğŸ‡','ğŸ•´','ğŸ†','ğŸ½','ğŸ…','ğŸ–','ğŸ—','ğŸµ','ğŸ«','ğŸŸ','ğŸ­','ğŸ¨','ğŸª','ğŸ¤','ğŸ§','ğŸ¼','ğŸ¹','ğŸ·','ğŸº','ğŸ¸','ğŸ»','ğŸ¬','ğŸ®','ğŸ‘¾','ğŸ¯','ğŸ²','ğŸ°','ğŸ³','ğŸš—','ğŸš•','ğŸš™','ğŸšŒ','ğŸš','ğŸ','ğŸš“','ğŸš‘','ğŸš’','ğŸš','ğŸšš','ğŸš›','ğŸšœ','ğŸ','ğŸš²','ğŸš¨','ğŸš”','ğŸš','ğŸš˜','ğŸš–','ğŸš¡','ğŸš ','ğŸšŸ','ğŸšƒ','ğŸš‹','ğŸš','ğŸš„','ğŸš…','ğŸšˆ','ğŸš','ğŸš‚','ğŸš†','ğŸš‡','ğŸšŠ','ğŸš‰','ğŸš','ğŸ›©','âœˆï¸','ğŸ›«','ğŸ›¬','â›µï¸','ğŸ›¥','ğŸš¤','â›´','ğŸ›³','ğŸš€','ğŸ›°','ğŸ’º','âš“ï¸','ğŸš§','â›½ï¸','ğŸš','ğŸš¦','ğŸš¥','ğŸ','ğŸš¢','ğŸ¡','ğŸ¢','ğŸ ','ğŸ—','ğŸŒ','ğŸ—¼','ğŸ­','â›²ï¸','ğŸ‘','â›°','ğŸ”','ğŸ—»','ğŸŒ‹','ğŸ—¾','ğŸ•','â›ºï¸','ğŸ','ğŸ›£','ğŸ›¤','ğŸŒ…','ğŸŒ„','ğŸœ','ğŸ–','ğŸ','ğŸŒ‡','ğŸŒ†','ğŸ™','ğŸŒƒ','ğŸŒ‰','ğŸŒŒ','ğŸŒ ','ğŸ‡','ğŸ†','ğŸŒˆ','ğŸ˜','ğŸ°','ğŸ¯','ğŸŸ','ğŸ—½','ğŸ ','ğŸ¡','ğŸš','ğŸ¢','ğŸ¬','ğŸ£','ğŸ¤','ğŸ¥','ğŸ¦','ğŸ¨','ğŸª','ğŸ«','ğŸ©','ğŸ’’','ğŸ›','â›ªï¸','ğŸ•Œ','ğŸ•','ğŸ•‹','â›©âŒšï¸','ğŸ“±','ğŸ“²','ğŸ’»','âŒ¨','ğŸ–¥','ğŸ–¨','ğŸ–±','ğŸ–²','ğŸ•¹','ğŸ—œ','ğŸ’½','ğŸ’¾','ğŸ’¿','ğŸ“€','ğŸ“¼','ğŸ“·','ğŸ“¸','ğŸ“¹','ğŸ¥','ğŸ“½','ğŸ','ğŸ“','â˜ï¸','ğŸ“Ÿ','ğŸ“ ','ğŸ“º','ğŸ“»','ğŸ™','ğŸš','ğŸ›','â±','â²','â°','ğŸ•°','â³','âŒ›ï¸','ğŸ“¡','ğŸ”‹','ğŸ”Œ','ğŸ’¡','ğŸ”¦','ğŸ•¯','ğŸ—‘','ğŸ›¢','ğŸ’¸','ğŸ’µ','ğŸ’´','ğŸ’¶','ğŸ’·','ğŸ’°','ğŸ’³','ğŸ’','âš–','ğŸ”§','ğŸ”¨','âš’','ğŸ› ','â›','ğŸ”©','âš™','â›“','ğŸ”«','ğŸ’£','ğŸ”ª','ğŸ—¡','âš”','ğŸ›¡','ğŸš¬','â˜ ','âš°','âš±','ğŸº','ğŸ”®','ğŸ“¿','ğŸ’ˆ','âš—','ğŸ”­','ğŸ”¬','ğŸ•³','ğŸ’Š','ğŸ’‰','ğŸŒ¡','ğŸ·','ğŸ”–','ğŸš½','ğŸš¿','ğŸ›','ğŸ”‘','ğŸ—','ğŸ›‹','ğŸ›Œ','ğŸ›','ğŸšª','ğŸ›','ğŸ–¼','ğŸ—º','â›±','ğŸ—¿','ğŸ›','ğŸˆ','ğŸ','ğŸ€','ğŸ','ğŸŠ','ğŸ‰','ğŸ','ğŸ','ğŸŒ','ğŸ®','âœ‰ï¸','ğŸ“©','ğŸ“¨','ğŸ“§','ğŸ’Œ','ğŸ“®','ğŸ“ª','ğŸ“«','ğŸ“¬','ğŸ“­','ğŸ“¦','ğŸ“¯','ğŸ“¥','ğŸ“¤','ğŸ“œ','ğŸ“ƒ','ğŸ“‘','ğŸ“Š','ğŸ“ˆ','ğŸ“‰','ğŸ“„','ğŸ“…','ğŸ“†','ğŸ—“','ğŸ“‡','ğŸ—ƒ','ğŸ—³','ğŸ—„','ğŸ“‹','ğŸ—’','ğŸ“','ğŸ“‚','ğŸ—‚','ğŸ—','ğŸ“°','ğŸ““','ğŸ“•','ğŸ“—','ğŸ“˜','ğŸ“™','ğŸ“”','ğŸ“’','ğŸ“š','ğŸ“–','ğŸ”—','ğŸ“','ğŸ–‡','âœ‚ï¸','ğŸ“','ğŸ“','ğŸ“Œ','ğŸ“','ğŸš©','ğŸ³','ğŸ´','ğŸ”','ğŸ”’','ğŸ”“','ğŸ”','ğŸ–Š','ğŸ–Š','ğŸ–‹','âœ’ï¸','ğŸ“','âœï¸','ğŸ–','ğŸ–Œ','ğŸ”','ğŸ”â¤ï¸','ğŸ’›','ğŸ’™','ğŸ’œ','ğŸ’”','â£ï¸','ğŸ’•','ğŸ’','ğŸ’“','ğŸ’—','ğŸ’–','ğŸ’˜','ğŸ’','ğŸ’Ÿ','â˜®','âœï¸','â˜ª','ğŸ•‰','â˜¸','âœ¡ï¸','ğŸ”¯','ğŸ•','â˜¯ï¸','â˜¦','ğŸ›','â›','â™ˆï¸','â™‰ï¸','â™Šï¸','â™‹ï¸','â™Œï¸','â™ï¸','â™ï¸','â™ï¸','â™ï¸','â™‘ï¸','â™’ï¸','â™“ï¸','ğŸ†”','âš›','ğŸˆ³','ğŸˆ¹','â˜¢','â˜£','ğŸ“´','ğŸ“³','ğŸˆ¶','ğŸˆšï¸','ğŸˆ¸','ğŸˆº','ğŸˆ·ï¸','âœ´ï¸','ğŸ†š','ğŸ‰‘','ğŸ’®','ğŸ‰','ãŠ™ï¸','ãŠ—ï¸','ğŸˆ´','ğŸˆµ','ğŸˆ²','ğŸ…°ï¸','ğŸ…±ï¸','ğŸ†','ğŸ†‘','ğŸ…¾ï¸','ğŸ†˜','â›”ï¸','ğŸ“›','ğŸš«','âŒ','â­•ï¸','ğŸ’¢','â™¨ï¸','ğŸš·','ğŸš¯','ğŸš³','ğŸš±','ğŸ”','ğŸ“µ','â—ï¸','â•','â“','â”','â€¼ï¸','â‰ï¸','ğŸ’¯','ğŸ”…','ğŸ”†','ğŸ”±','âšœ','ã€½ï¸','âš ï¸','ğŸš¸','ğŸ”°','â™»ï¸','ğŸˆ¯ï¸','ğŸ’¹','â‡ï¸','âœ³ï¸','â','âœ…','ğŸ’ ','ğŸŒ€','â¿','ğŸŒ','â“‚ï¸','ğŸ§','ğŸˆ‚ï¸','ğŸ›‚','ğŸ›ƒ','ğŸ›„','ğŸ›…','â™¿ï¸','ğŸš­','ğŸš¾','ğŸ…¿ï¸','ğŸš°','ğŸš¹','ğŸšº','ğŸš¼','ğŸš»','ğŸš®','ğŸ¦','ğŸ“¶','ğŸˆ','ğŸ†–','ğŸ†—','ğŸ†™','ğŸ†’','ğŸ†•','ğŸ†“','0ï¸âƒ£','1ï¸âƒ£','2ï¸âƒ£','3ï¸âƒ£','4ï¸âƒ£','5ï¸âƒ£','6ï¸âƒ£','7ï¸âƒ£','8ï¸âƒ£','9ï¸âƒ£','ğŸ”Ÿ','ğŸ”¢','â–¶ï¸','â¸','â¯','â¹','âº','â­','â®','â©','âª','ğŸ”€','ğŸ”','ğŸ”‚','â—€ï¸','ğŸ”¼','ğŸ”½','â«','â¬','â¡ï¸','â¬…ï¸','â¬†ï¸','â¬‡ï¸','â†—ï¸','â†˜ï¸','â†™ï¸','â†–ï¸','â†•ï¸','â†”ï¸','ğŸ”„','â†ªï¸','â†©ï¸','â¤´ï¸','â¤µï¸','#ï¸âƒ£','*ï¸âƒ£','â„¹ï¸','ğŸ”¤','ğŸ”¡','ğŸ” ','ğŸ”£','ğŸµ','ğŸ¶','ã€°ï¸','â°','âœ”ï¸','ğŸ”ƒ','â•','â–','â—','âœ–ï¸','ğŸ’²','ğŸ’±','Â©ï¸','Â®ï¸','â„¢ï¸','ğŸ”š','ğŸ”™','ğŸ”›','ğŸ”','ğŸ”œ','â˜‘ï¸','ğŸ”˜','âšªï¸','âš«ï¸','ğŸ”´','ğŸ”µ','ğŸ”¸','ğŸ”¹','ğŸ”¶','ğŸ”·','ğŸ”º','â–ªï¸','â–«ï¸','â¬›ï¸','â¬œï¸','ğŸ”»','â—¼ï¸','â—»ï¸','â—¾ï¸','â—½ï¸','ğŸ”²','ğŸ”³','ğŸ”ˆ','ğŸ”‰','ğŸ”Š','ğŸ”‡','ğŸ“£','ğŸ“¢','ğŸ””','ğŸ”•','ğŸƒ','ğŸ€„ï¸','â™ ï¸','â™£ï¸','â™¥ï¸','â™¦ï¸','ğŸ´','ğŸ‘â€ğŸ—¨','ğŸ’­','ğŸ—¯','ğŸ’¬','ğŸ•','ğŸ•‘','ğŸ•’','ğŸ•“','ğŸ•”','ğŸ••','ğŸ•–','ğŸ•—','ğŸ•˜','ğŸ•™','ğŸ•š','ğŸ•›','ğŸ•œ','ğŸ•','ğŸ•','ğŸ•Ÿ','ğŸ• ','ğŸ•¡','ğŸ•¢','ğŸ•£','ğŸ•¤','ğŸ•¥','ğŸ•¦','ğŸ•§','ğŸ‡¦ğŸ‡«','ğŸ‡¦ğŸ‡½','ğŸ‡¦ğŸ‡±','ğŸ‡©ğŸ‡¿','ğŸ‡¦ğŸ‡¸','ğŸ‡¦ğŸ‡©','ğŸ‡¦ğŸ‡´','ğŸ‡¦ğŸ‡®','ğŸ‡¦ğŸ‡¶','ğŸ‡¦ğŸ‡¬','ğŸ‡¦ğŸ‡·','ğŸ‡¦ğŸ‡²','ğŸ‡¦ğŸ‡¼','ğŸ‡¦ğŸ‡º','ğŸ‡¦ğŸ‡¹','ğŸ‡¦ğŸ‡¿','ğŸ‡§ğŸ‡¸','ğŸ‡§ğŸ‡­','ğŸ‡§ğŸ‡©','ğŸ‡§ğŸ‡§','ğŸ‡§ğŸ‡¾','ğŸ‡§ğŸ‡ª','ğŸ‡§ğŸ‡¿','ğŸ‡§ğŸ‡¯','ğŸ‡§ğŸ‡²','ğŸ‡§ğŸ‡¹','ğŸ‡§ğŸ‡´','ğŸ‡§ğŸ‡¶','ğŸ‡§ğŸ‡¦','ğŸ‡§ğŸ‡¼','ğŸ‡§ğŸ‡·','ğŸ‡®ğŸ‡´','ğŸ‡»ğŸ‡¬','ğŸ‡§ğŸ‡³','ğŸ‡§ğŸ‡¬','ğŸ‡§ğŸ‡«','ğŸ‡§ğŸ‡®','ğŸ‡¨ğŸ‡»','ğŸ‡°ğŸ‡­','ğŸ‡¨ğŸ‡²','ğŸ‡¨ğŸ‡¦','ğŸ‡®ğŸ‡¨','ğŸ‡°ğŸ‡¾','ğŸ‡¨ğŸ‡«','ğŸ‡¹ğŸ‡©','ğŸ‡¨ğŸ‡±','ğŸ‡¨ğŸ‡³','ğŸ‡¨ğŸ‡½','ğŸ‡¨ğŸ‡¨','ğŸ‡¨ğŸ‡´','ğŸ‡°ğŸ‡²','ğŸ‡¨ğŸ‡¬','ğŸ‡¨ğŸ‡©','ğŸ‡¨ğŸ‡°','ğŸ‡¨ğŸ‡·','ğŸ‡­ğŸ‡·','ğŸ‡¨ğŸ‡º','ğŸ‡¨ğŸ‡¼','ğŸ‡¨ğŸ‡¾','ğŸ‡¨ğŸ‡¿','ğŸ‡©ğŸ‡°','ğŸ‡©ğŸ‡¯','ğŸ‡©ğŸ‡²','ğŸ‡©ğŸ‡´','ğŸ‡ªğŸ‡¨','ğŸ‡ªğŸ‡¬','ğŸ‡¸ğŸ‡»','ğŸ‡¬ğŸ‡¶','ğŸ‡ªğŸ‡·','ğŸ‡ªğŸ‡ª','ğŸ‡ªğŸ‡¹','ğŸ‡ªğŸ‡º','ğŸ‡«ğŸ‡°','ğŸ‡«ğŸ‡´','ğŸ‡«ğŸ‡¯','ğŸ‡«ğŸ‡®','ğŸ‡«ğŸ‡·','ğŸ‡¬ğŸ‡«','ğŸ‡µğŸ‡«','ğŸ‡¹ğŸ‡«','ğŸ‡¬ğŸ‡¦','ğŸ‡¬ğŸ‡²','ğŸ‡¬ğŸ‡ª','ğŸ‡©ğŸ‡ª','ğŸ‡¬ğŸ‡­','ğŸ‡¬ğŸ‡®','ğŸ‡¬ğŸ‡·','ğŸ‡¬ğŸ‡±','ğŸ‡¬ğŸ‡©','ğŸ‡¬ğŸ‡µ','ğŸ‡¬ğŸ‡º','ğŸ‡¬ğŸ‡¹','ğŸ‡¬ğŸ‡¬','ğŸ‡¬ğŸ‡³','ğŸ‡¬ğŸ‡¼','ğŸ‡¬ğŸ‡¾','ğŸ‡­ğŸ‡¹','ğŸ‡­ğŸ‡³','ğŸ‡­ğŸ‡°','ğŸ‡­ğŸ‡º','ğŸ‡®ğŸ‡¸','ğŸ‡®ğŸ‡³','ğŸ‡®ğŸ‡©','ğŸ‡®ğŸ‡·','ğŸ‡®ğŸ‡¶','ğŸ‡®ğŸ‡ª','ğŸ‡®ğŸ‡²','ğŸ‡®ğŸ‡±','ğŸ‡®ğŸ‡¹','ğŸ‡¨ğŸ‡®','ğŸ‡¯ğŸ‡²','ğŸ‡¯ğŸ‡µ','ğŸ‡¯ğŸ‡ª','ğŸ‡¯ğŸ‡´','ğŸ‡°ğŸ‡¿','ğŸ‡°ğŸ‡ª','ğŸ‡°ğŸ‡®','ğŸ‡½ğŸ‡°','ğŸ‡°ğŸ‡¼','ğŸ‡°ğŸ‡¬','ğŸ‡±ğŸ‡¦','ğŸ‡±ğŸ‡»','ğŸ‡±ğŸ‡§','ğŸ‡±ğŸ‡¸','ğŸ‡±ğŸ‡·','ğŸ‡±ğŸ‡¾','ğŸ‡±ğŸ‡®','ğŸ‡±ğŸ‡¹','ğŸ‡±ğŸ‡º','ğŸ‡²ğŸ‡´','ğŸ‡²ğŸ‡°','ğŸ‡²ğŸ‡¬','ğŸ‡²ğŸ‡¼','ğŸ‡²ğŸ‡¾','ğŸ‡²ğŸ‡»','ğŸ‡²ğŸ‡±','ğŸ‡²ğŸ‡¹','ğŸ‡²ğŸ‡­','ğŸ‡²ğŸ‡¶','ğŸ‡²ğŸ‡·','ğŸ‡²ğŸ‡º','ğŸ‡¾ğŸ‡¹','ğŸ‡²ğŸ‡½','ğŸ‡«ğŸ‡²','ğŸ‡²ğŸ‡©','ğŸ‡²ğŸ‡¨','ğŸ‡²ğŸ‡³','ğŸ‡²ğŸ‡ª','ğŸ‡²ğŸ‡¸','ğŸ‡²ğŸ‡¦','ğŸ‡²ğŸ‡¿','ğŸ‡²ğŸ‡²','ğŸ‡³ğŸ‡¦','ğŸ‡³ğŸ‡·','ğŸ‡³ğŸ‡µ','ğŸ‡³ğŸ‡±','ğŸ‡³ğŸ‡¨','ğŸ‡³ğŸ‡¿','ğŸ‡³ğŸ‡®','ğŸ‡³ğŸ‡ª','ğŸ‡³ğŸ‡¬','ğŸ‡³ğŸ‡º','ğŸ‡³ğŸ‡«','ğŸ‡²ğŸ‡µ','ğŸ‡°ğŸ‡µ','ğŸ‡³ğŸ‡´','ğŸ‡´ğŸ‡²','ğŸ‡µğŸ‡°','ğŸ‡µğŸ‡¼','ğŸ‡µğŸ‡¸','ğŸ‡µğŸ‡¦','ğŸ‡µğŸ‡¬','ğŸ‡µğŸ‡¾','ğŸ‡µğŸ‡ª','ğŸ‡µğŸ‡­','ğŸ‡µğŸ‡³','ğŸ‡µğŸ‡±','ğŸ‡µğŸ‡¹','ğŸ‡µğŸ‡·','ğŸ‡¶ğŸ‡¦','ğŸ‡·ğŸ‡ª','ğŸ‡·ğŸ‡´','ğŸ‡·ğŸ‡º','ğŸ‡·ğŸ‡¼','ğŸ‡§ğŸ‡±','ğŸ‡¸ğŸ‡­','ğŸ‡°ğŸ‡³','ğŸ‡±ğŸ‡¨','ğŸ‡µğŸ‡²','ğŸ‡»ğŸ‡¨','ğŸ‡¼ğŸ‡¸','ğŸ‡¸ğŸ‡²','ğŸ‡¸ğŸ‡¹','ğŸ‡¸ğŸ‡¦','ğŸ‡¸ğŸ‡³','ğŸ‡·ğŸ‡¸','ğŸ‡¸ğŸ‡¨','ğŸ‡¸ğŸ‡±','ğŸ‡¸ğŸ‡¬','ğŸ‡¸ğŸ‡½','ğŸ‡¸ğŸ‡°','ğŸ‡¸ğŸ‡®','ğŸ‡¸ğŸ‡§','ğŸ‡¸ğŸ‡´','ğŸ‡¿ğŸ‡¦','ğŸ‡¬ğŸ‡¸','ğŸ‡°ğŸ‡·','ğŸ‡¸ğŸ‡¸','ğŸ‡ªğŸ‡¸','ğŸ‡±ğŸ‡°','ğŸ‡¸ğŸ‡©','ğŸ‡¸ğŸ‡·','ğŸ‡¸ğŸ‡¿','ğŸ‡¸ğŸ‡ª','ğŸ‡¨ğŸ‡­','ğŸ‡¸ğŸ‡¾','ğŸ‡¹ğŸ‡¼','ğŸ‡¹ğŸ‡¯','ğŸ‡¹ğŸ‡¿','ğŸ‡¹ğŸ‡­','ğŸ‡¹ğŸ‡±','ğŸ‡¹ğŸ‡¬','ğŸ‡¹ğŸ‡°','ğŸ‡¹ğŸ‡´','ğŸ‡¹ğŸ‡¹','ğŸ‡¹ğŸ‡³','ğŸ‡¹ğŸ‡·','ğŸ‡¹ğŸ‡²','ğŸ‡¹ğŸ‡¨','ğŸ‡¹ğŸ‡»','ğŸ‡ºğŸ‡¬','ğŸ‡ºğŸ‡¦','ğŸ‡¦ğŸ‡ª','ğŸ‡¬ğŸ‡§','ğŸ‡ºğŸ‡¸','ğŸ‡»ğŸ‡®','ğŸ‡ºğŸ‡¾','ğŸ‡ºğŸ‡¿','ğŸ‡»ğŸ‡º','ğŸ‡»ğŸ‡¦','ğŸ‡»ğŸ‡ª','ğŸ‡»ğŸ‡³','ğŸ‡¼ğŸ‡«','ğŸ‡ªğŸ‡­','ğŸ‡¾ğŸ‡ª','ğŸ‡¿ğŸ‡²','ğŸ‡¿ğŸ‡¼ğŸ¤£','ğŸ¤ ','ğŸ¤¡','ğŸ¤¥','ğŸ¤¤','ğŸ¤¢','ğŸ¤§','ğŸ¤´','ğŸ¤¶','ğŸ¤µ','ğŸ¤·','ğŸ¤¦','ğŸ¤°','ğŸ•º','ğŸ¤³','ğŸ¤','ğŸ¤™','ğŸ¤›','ğŸ¤œ','ğŸ¤š','ğŸ¤','ğŸ–¤','ğŸ¦','ğŸ¦Š','ğŸ¦Œ','ğŸ¦','ğŸ¦‡','ğŸ¦…','ğŸ¦†','ğŸ¦‰','ğŸ¦','ğŸ¦ˆ','ğŸ¦','ğŸ¦‘','ğŸ¦‹','ğŸ¥€','ğŸ¥','ğŸ¥‘','ğŸ¥”','ğŸ¥•','ğŸ¥’','ğŸ¥œ','ğŸ¥','ğŸ¥–','ğŸ¥','ğŸ¥“','ğŸ¥™','ğŸ¥š','ğŸ¥˜','ğŸ¥—','ğŸ¥›','ğŸ¥‚','ğŸ¥ƒ','ğŸ¥„','ğŸ›‘','ğŸ›´','ğŸ›µ','ğŸ›¶','ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰','ğŸ¥Š','ğŸ¥‹','ğŸ¤¸','ğŸ¤¼','ğŸ¤½','ğŸ¤¾','ğŸ¤º','ğŸ¥…','ğŸ¤¹','ğŸ¥','ğŸ›’'];

router.get('/api/listen', function(req,res){
  console.log("here");
  client.stream('statuses/filter',{track: '#emojicon'}, function(stream){
    stream.on('data', function(tweet) { 
      console.log(tweet.text);
      checkForEmoji(tweet.text);
    });
    stream.on('error', function(error){
      console.log(error);
    });
  });
  res.render('index.html')
})

router.get('/api/getEmojis', function(req,res){
  var pull = Emoji.find().sort({num:-1});
  pull.exec(function(err, data){
      console.log("pulling in mongodb");
    // if err or no emojis found, respond with error 
    if(err || data == null){
      var error = {status:'ERROR', message: 'Could not find emojis'};
      console.log(error);
      return res.json(error);
    }

    // otherwise, respond with the data 
    var jsonData = {
      status: 'OK',
      emoji: data
    } 
    //console.log(jsonData);

    return res.jsonp(jsonData);
  });
})

router.get('/api/getTopEmojis', function(req,res){
   var topTenEmojis = Emoji.find().sort({num:-1}).limit(10);
   topTenEmojis.exec(function(err,data){
    if (err){return err;}
    var jsonData={
      status: 'OK',
      emoji: data
    }
    console.log(jsonData);
    return res.jsonp(jsonData);
   })
})

function checkForEmoji(tweet){
  var emojis =[], x=0, boo;
  for(var i in allEmojis){
     if(tweet.includes(allEmojis[i])){
      //console.log(allEmojis[i]);
      emojis[x] = allEmojis[i];
      x++;
      boo = true;
     }
  }
  if(boo){
    for(var i in emojis){
      checkforEmojiOnServer(emojis[i]);
    }
  }
}

function checkforEmojiOnServer(e, res){
  console.log("searching server for "+e);
  Emoji.find({type: e}, function(err,data){
    if(data==null || data.length==0){
      var message = {status:'NO RESULTS', message: 'We couldn\'t find any results'};
      postToServer(e);   
    } else{
      console.log("got to updating count");
      var jsonData = {
          status: 'OK',
          emoji: data
      } 
      console.log(jsonData.emoji[0]._id);
      updateEmojiCount(jsonData.emoji[0]._id, jsonData.emoji[0].num);
    }
  });
} 

function updateEmojiCount(id, count, res){
  console.log("updating emoji count");
  var requestedId = id;

   var dataToUpdate = {}; // a blank object of data to update

    var number = count+1;
    dataToUpdate['num'] = number;

    Emoji.findByIdAndUpdate(requestedId, dataToUpdate, function(err,data){
      console.log(data);
    })
}

function postToServer(tweetEmojis, res){
  console.log("posting to server"+tweetEmojis);
   var type = tweetEmojis;
   var num = 0;
    var emojiObj ={
      type: type,
      num: num
    };
    var emoji = new Emoji(emojiObj);
  emoji.save(function(err,data){
      if(err){
        var error ={status:'ERROR', message: 'Error saving emoji'};
        console.log(error);
        return res.json(error);
      }
      console.log('saved new emoji: '+type);

    })
 } 



module.exports = router;